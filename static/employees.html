<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Employees UI</title>

  <style>
    body {
      background: linear-gradient(135deg, #0d0d0d, #232323);
      color: white;
      font-family: Arial;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #00eaff;
      text-shadow: 0 0 20px #00eaff;
    }

    .glass-form {
      width: 400px;
      margin: auto;
      padding: 25px;
      border-radius: 20px;
      background: rgba(255,255,255,0.07);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.15);
      box-shadow: 0 0 25px rgba(0,0,0,0.4);
    }

    input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
      border: none;
      outline: none;
      font-size: 16px;
      background: rgba(255,255,255,0.15);
      color: white;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-top: 10px;
      border-radius: 10px;
      border: none;
      background: linear-gradient(135deg, #00aaff, #0044ff);
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px #0099ff;
    }

    .card {
      padding: 18px;
      margin: 12px auto;
      width: 90%;
      border-radius: 14px;
      background: linear-gradient(135deg, #444, #222);
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
    }

    .actions button {
      margin-right: 8px;
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
    }

    /* Bar Loader */
    .loader {
      width: 120px;
      height: 8px;
      margin: 20px auto;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      overflow: hidden;
      display: none;
    }

    .loader-bar {
      width: 40px;
      height: 100%;
      background: #00eaff;
      animation: loading 1s infinite ease-in-out;
    }

    @keyframes loading {
      0% { transform: translateX(-40px); }
      100% { transform: translateX(120px); }
    }
  </style>
</head>

<body>


<!-- Page Heading -->
<h1>Employee Management</h1>

<!-- Add Employee Form -->
<div class="glass-form">
  <input id="emp_id" placeholder="Employee ID" />
  <input id="name" placeholder="Name" />
  <input id="job_role" placeholder="Job Role" />
  <button onclick="addEmployee()">Add Employee</button>
</div>

<!-- Loader -->
<div class="loader" id="loader">
  <div class="loader-bar"></div>
</div>

<h2 style="text-align:center;margin-top:40px;">Employees List</h2>

<div id="list"></div>

<script>
  const api = '/employees';

  function showLoader(show) {
    document.getElementById("loader").style.display = show ? "block" : "none";
  }

  async function loadEmployees() {
    showLoader(true);
    const res = await fetch(api);
    const data = await res.json();
    showLoader(false);

    const list = document.getElementById("list");
    list.innerHTML = "";

    data.forEach(emp => {
      list.innerHTML += `
        <div class="card">
          <b>${emp.emp_id}</b> â€” ${emp.name}<br>
          Role: ${emp.job_role}
          <div class="actions">
            <button onclick="editEmployee('${emp.emp_id}')">Edit</button>
            <button onclick="deleteEmployee('${emp.emp_id}')">Delete</button>
          </div>
        </div>`;
    });
  }

  async function addEmployee() {
    const emp_id = document.getElementById("emp_id").value;
    const name = document.getElementById("name").value;
    const job_role = document.getElementById("job_role").value;

    await fetch(api, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ emp_id, name, job_role })
    });

    loadEmployees();
  }

  async function editEmployee(id) {
    const newName = prompt("New Name:");
    const newRole = prompt("New Job Role:");

    await fetch(`${api}/${id}`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: newName, job_role: newRole })
    });

    loadEmployees();
  }

  async function deleteEmployee(id) {
    await fetch(`${api}/${id}`, { method: "DELETE" });
    loadEmployees();
  }

  loadEmployees();
</script>

</body>
</html>
